// Created on iPad.
/////////////////////////
//å¸¦å¤´å•é“¾è¡¨çš„åˆ›å»ºä»¥åŠåŸºæœ¬æ“ä½œ
/////////////////////////
#include <iostream>
using namespace std;

//å®šä¹‰æ•°æ®ç»“æ„
typedef struct ElemType{
    int data;
}ElemType;


//å®šä¹‰é“¾è¡¨èŠ‚ç‚¹
typedef struct LNode{
    int data; //æ•°æ®åŸŸ
    struct LNode *next;//æŒ‡é’ˆåŸŸ
}LNode, *LinkList; //åˆ«å

//å•é“¾è¡¨åˆå§‹åŒ–
void InitList(LinkList &L){
    L =(LNode *)malloc(sizeof(LinkList));
    L->next = NULL;//ç”³è¯·å†…å­˜ç©ºé—´åï¼Œå°†æŒ‡é’ˆåŸŸç½®ç©º
    printf("å•é“¾è¡¨åˆå§‹åŒ–å®Œæˆ \n");
}



//**********************å•é“¾è¡¨çš„åˆ›å»º
//å¤´æ’æ³•åˆ›å»ºå•é“¾è¡¨
 LinkList List_HeadInsert(LinkList &L){ //é€†å‘å»ºç«‹å•é“¾è¡¨
    InitList(L);//åˆå§‹åŒ–è¡¨å¤´
    LNode *s;//ç”¨äºç”³è¯·æ–°èŠ‚ç‚¹çš„ç©ºé—´å¹¶æ’å…¥å•é“¾è¡¨ä¸­
    int x;//ç”¨äºå­˜å‚¨è·å–é”®ç›˜çš„è¾“å…¥å€¼
    printf("è¯·è¾“å…¥åˆ›å»ºé“¾è¡¨çš„æ–°å€¼ï¼Œæ¯è¾“å…¥ä¸€ä¸ªæ–°å€¼åå›è½¦ç¡®è®¤ï¼Œå¦‚æœä¸éœ€è¦å†æ’å…¥æ–°å€¼ï¼Œè¯·å‡ºå…¥9999ç»“æŸåˆ›å»º\n");
    scanf("%d",&x); //è¾“å…¥èŠ‚ç‚¹çš„å€¼
    while(x!=9999){
        s=(LNode *)malloc(sizeof(LNode));//ä¸ºæ–°èŠ‚ç‚¹ç”³è¯·å†…å­˜ï¼Œç›¸å½“äºåˆ›å»ºæ–°èŠ‚ç‚¹
        s->data=x;//å°†æ–°å€¼æ³¨å…¥æ–°èŠ‚ç‚¹
        s->next=L->next; //å°†è¡¨å¤´çš„åç»§ å¤åˆ¶ç»™æ–°èŠ‚ç‚¹
        L->next=s;  //è¡¨å¤´çš„åç»§å˜ä¸º æ–°èŠ‚ç‚¹
        scanf("%d",&x);
    }
    printf("æ–°é“¾è¡¨ä½¿ç”¨å¤´æ’æ³•å»ºç«‹å®Œæˆ \n");
    return L;
}

//å°¾æ’æ³•åˆ›å»ºå•é“¾è¡¨
LinkList List_TailInsert(LinkList &L){
    InitList(L);//åˆå§‹åŒ–é“¾è¡¨
    LNode *s,*r=L;// s ç”¨äºç”³è¯·æ–°èŠ‚ç‚¹ç©ºé—´,r ä¿å­˜æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼ˆå³è¡¨å°¾æŒ‡é’ˆï¼‰ 
    int x;//æ’å…¥çš„æ–°å€¼
    printf("è¯·è¾“å…¥åˆ›å»ºé“¾è¡¨çš„æ–°å€¼ï¼Œæ¯è¾“å…¥ä¸€ä¸ªæ–°å€¼åå›è½¦ç¡®è®¤ï¼Œå¦‚æœä¸éœ€è¦å†æ’å…¥æ–°å€¼ï¼Œè¯·å‡ºå…¥9999ç»“æŸåˆ›å»º\n");
    scanf("%d",&x);//ä»é”®ç›˜ä¸­è·å–æ–°å€¼
    while(x!=9999){
        s=(LNode *)malloc(sizeof(LNode));//ä¸ºæ–°èŠ‚ç‚¹ç”³è¯·å†…å­˜ç©ºé—´ï¼Œå³åˆ›å»ºæ–°èŠ‚ç‚¹
        //s->next=NULL;//å°å°¾å·´å¤„ç†ï¼Œå› ä¸ºä½ åœ¨å°¾å·´ï¼Œæ‰€ä»¥ä½ çš„å°¾å·´ä¸èƒ½å‘ç€åˆ«äºº
        s->data=x;//å­˜å…¥æ–°å€¼
        r->next=s;//é“¾è¡¨çš„åç»§æŒ‡å‘æ–°çš„èŠ‚ç‚¹ ï¼Œå³r->next ä»£è¡¨ L->next
        r=s;//å°†rå˜ä¸ºæœ€æ–°çš„å°¾èŠ‚ç‚¹ã€
        scanf("%d",&x);
    }
    r->next=NULL; //å°¾èŠ‚ç‚¹ç½®ç©ºï¼Œé˜²æ­¢å°¾æŒ‡é’ˆä¸ºè„æ•°æ®æ‰€æŒ‡çš„åœ°å€
    printf("æ–°é“¾è¡¨ä½¿ç”¨å°¾æ’æ³•å»ºç«‹å®Œæˆ \n");
    return L;
}




//**********************å•é“¾è¡¨çš„æŸ¥è¯¢
//æŒ‰åºå·æŸ¥æ‰¾èŠ‚ç‚¹å€¼,æŸ¥æ‰¾ç¬¬iä¸ªèŠ‚ç‚¹ï¼Œå¹¶è¿”å›è¯¥èŠ‚ç‚¹ï¼ˆçš„æŒ‡é’ˆï¼‰
LNode * GetElem(LinkList L,int i){
    int j=1;                    //ä»£è¡¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
    LNode *p=L->next;           //å°†è¡¨å¤´çš„åç»§ç»™pï¼Œè¡¨ç¤ºç¬¬1ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆèµ‹å€¼ç»™p
    if(i==0)
        return L;               //è‹¥i=0ç›¸å½“äºè¿”å›è¡¨å¤´
    if(i<1)
        return NULL;            //å³ç„¶ iä¸ä¸º0ï¼Œåˆå°äº1ï¼Œåˆ™içš„å€¼ä¸åˆæ³•ï¼Œè¿”å› NULLè¡¨ç¤ºiå€¼ä¸åˆæ³•
    while(p != NULL && j<i){    //ä»ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾åˆ°ç¬¬iä¸ªèŠ‚ç‚¹ï¼Œå½“j=iæ—¶ï¼Œå³æŸ¥æ‰¾åˆ°äº†ç¬¬iä¸ªèŠ‚ç‚¹ï¼Œé€šçŸ¥ä¸ç¬¦åˆæ¡ä»¶ï¼Œè·³å‡ºå¾ªç¯
        p=p->next;              //åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæŒ‡é’ˆ
        j++;                    //è®¡æ•°å¢åŠ ï¼Œä»£è¡¨æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå½“å‰èŠ‚ç‚¹ä¸ºç¬¬jä¸ªèŠ‚ç‚¹
    }
    return p;                   //è¿”å›ç¬¬iä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œè‹¥iå¤§äºè¡¨é•¿ï¼Œåˆ™è¿”å›NULLï¼Œå› ä¸ºå½“æŸ¥è¯¢åˆ°æœ€åä¸€ä¸ªèŠ‚ç‚¹æ˜¯ï¼Œå°¾èŠ‚ç‚¹çš„åç»§ä¸ºNULL
}

//æŒ‰å€¼æŸ¥æ‰¾è¡¨èŠ‚ç‚¹ æ³¨æ„ï¼šè¿”å›çš„èŠ‚ç‚¹æ˜¯æŸ¥æ‰¾åˆ°çš„ç¬¬ä¸€ä¸ªæ•°æ®åŒ¹é…çš„èŠ‚ç‚¹
LNode * LocateElem(LinkList L,int e){
    LNode *p=L->next;           //ç”¨äºå­˜å‚¨æŸ¥è¯¢åˆ°çš„èŠ‚ç‚¹ï¼Œå½“å‰æŒ‡å‘è¡¨å¤´æŒ‡å‘çš„ç¬¬1ä¸ªèŠ‚ç‚¹
    while(p!=NULL && p->data != e){ //ä»ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å¼€å§‹æŸ¥è¯¢ï¼Œå½“è¯¥èŠ‚ç‚¹ä¸ä¸ºç©ºï¼ŒåŒæ—¶è¯¥èŠ‚ç‚¹çš„çš„æ•°æ®åŸŸä¸ä¸ºæŸ¥è¯¢å€¼æ—¶ç»§ç»­å¾ªç¯ï¼Œï¼
    p= p->next; //Â åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
    }
    return p;                   //è¿”å›æŸ¥æ‰¾åˆ°çš„èŠ‚ç‚¹ï¼Œè‹¥æœªæ‰¾åˆ°ï¼Œåˆ™è¿”å› NULL
}

//**********************å•é“¾è¡¨çš„æ’å…¥
//å¯¹æŸèŠ‚ç‚¹åæ’å…¥è¿›è¡Œæ’å…¥
//å¯¹ç¬¬iä¸ªèŠ‚ç‚¹è¿›è¡Œåˆ é™¤
bool List_Insert(LinkList &L,int i,int e){
    LNode *p = GetElem(L,i-1);        //æ‰¾åˆ°ç¬¬iä¸ªå…ƒç´ çš„å‰ä¸€ä¸ªèŠ‚ç‚¹
    if(p==NULL) //åˆ¤è¯»æ˜¯å¦æŸ¥æ‰¾åˆ°èŠ‚ç‚¹ï¼Œè‹¥pä¸ºNULLï¼Œåˆ™è¡¨ç¤ºiä¸åˆæ³• 
        return false;
    LNode *s = (LNode*)malloc(sizeof(LNode));
    s->data=e;                          //å°†æ•°æ®é€å…¥èŠ‚ç‚¹
    s->next=p->next;                    //å°†ç¬¬i-1ä¸ªèŠ‚ç‚¹çš„åç»§ï¼ˆå³ç¬¬iä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆï¼‰å¤åˆ¶ç»™æ–°èŠ‚ç‚¹
    p->next=s;                          //æ›´æ”¹ç¬¬i-1ä¸ªèŠ‚ç‚¹çš„åç»§ä¸ºæ–°èŠ‚ç‚¹ï¼Œå³ç¬¬i-1ä¸ªèŠ‚ç‚¹åé¢æ¥ç€æ–°èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹åé¢æ¥ç€ç¬¬iä¸ªèŠ‚ç‚¹
    return true;
}

//å¯¹æŸä¸ªå€¼åé¢æ’å…¥æ–°å…ƒç´ 
bool List_InsertLocate(LinkList &L,int f,int e){
    LNode *p= LocateElem(L,f);//æŸ¥æ‰¾fçš„æ‰€åœ¨ä½ç½®ï¼Œå¹¶è¿”å›è¯¥èŠ‚ç‚¹
    if(p==NULL)     //åˆ¤æ–­è¿”å›çš„èŠ‚ç‚¹æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ºç©º åˆ™è¯¥åˆ—è¡¨ä¸­æ²¡æœ‰å…ƒç´  f
        return false;
    LNode *s = (LNode*)malloc(sizeof(LNode));
    s->data=e;                          //å°†æ•°æ®é€å…¥èŠ‚ç‚¹
    s->next=p->next;                    //å°†å«æœ‰få…ƒç´ çš„å‰èŠ‚ç‚¹çš„åç»§ å¤åˆ¶ç»™æ–°èŠ‚ç‚¹
    p->next=s;                          //æ›´æ”¹å«æœ‰få…ƒç´ çš„å‰èŠ‚ç‚¹çš„åç»§ä¸ºæ–°èŠ‚ç‚¹ï¼Œå³å«æœ‰få…ƒç´ çš„å‰èŠ‚ç‚¹åé¢æ¥ç€æ–°èŠ‚ç‚¹ï¼Œæ–°èŠ‚ç‚¹åé¢æ¥ç€å«æœ‰få…ƒç´ çš„èŠ‚ç‚¹
    return true;
}


//å¯¹æŸèŠ‚ç‚¹è¿›è¡Œå‰æ’æ“ä½œ
bool List_InsertFront(LNode *p,int e){
    if (p==NULL)//åˆ¤æ–­ç»™çš„èŠ‚ç‚¹æ˜¯å¦ä¸ºåˆæ³•èŠ‚ç‚¹ï¼Œç©ºèŠ‚ç‚¹æ²¡æœ‰dataï¼Œä¹Ÿæ²¡æœ‰åç»§ï¼Œå›å¯¼è‡´åé¢æ“ä½œå‡ºé”™
        return false;
    LNode *s = (LNode *)malloc(sizeof(LNode));
    s->data=p->data;          //ä¿å­˜åŸæ¥èŠ‚ç‚¹çš„å€¼
    s->next=p->next;            //ä¿å­˜åŸæ¥èŠ‚ç‚¹çš„åç»§
    p->data=e;                  //å°†æ–°å…ƒç´ æ”¾å…¥æ—§èŠ‚ç‚¹
    p->next=s;                  //å°†æ—§èŠ‚ç‚¹çš„åç»§æ”¹æˆæ–°èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å®Œæˆäº†å¯¹è¯¥èŠ‚ç‚¹çš„å‰æ’æ“ä½œï¼ˆå°±æ˜¯æŠŠåŸæ¥çš„èŠ‚ç‚¹å¾€åç§»åŠ¨äº†
    return true;

}




//**********************å•é“¾è¡¨çš„åˆ é™¤
//åˆ é™¤ç¬¬iä¸ªèŠ‚ç‚¹
int List_Del(LinkList &L,int i){
    LNode * p= GetElem(L,i-1); //è·å–è¢«åˆ èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹
    if(p==NULL)//åˆ¤æ–­è¿”å›èŠ‚ç‚¹æ˜¯å¦åˆæ³•ï¼Œè‹¥ä¸ºç©ºæ„å‘³ç€iä¸åˆæ³•
        return false;
    int e=p->data;          //ä¿å­˜åˆ é™¤èŠ‚ç‚¹çš„å€¼ï¼Œæœ€åè¿”å›
    LNode *q=p->next;       //å–å‡ºç¬¬iä¸ªèŠ‚ç‚¹ï¼ˆè¦åˆ é™¤çš„èŠ‚ç‚¹ï¼‰ï¼Œä¸ºäº†æ‹¿åˆ°å®ƒçš„åç»§
    p->next=q->next;        //å°†ç¬¬i-1ä¸ªèŠ‚ç‚¹çš„åç»§æ”¹ä¸ºiçš„åç»§ï¼ˆå³ç¬¬i+1ä¸ªèŠ‚ç‚¹ï¼‰
    free(q);                //é‡Šæ”¾ç¬¬iä¸ªèŠ‚ç‚¹çš„ç©ºé—´
    return e;
    
}

//åˆ é™¤èŠ‚ç‚¹*p
int List_DelPoint(LNode *p){
    if(p==NULL)         //åˆ¤æ–­è¯¥èŠ‚ç‚¹æ˜¯å¦åˆæ³•
        return false;
    LNode *q = p->next; //ä¿å­˜è¢«åˆ é™¤èŠ‚ç‚¹çš„åç»§
    int e=p->data;      //ä¿å­˜è¦è¢«åˆ é™¤èŠ‚ç‚¹ä¸­æ•°æ®
    p->data=q->data;    //å°†åç»§çš„æ•°æ®æ”¾å…¥æ—§èŠ‚ç‚¹
    p->next=q->next;    //å°†åç»§çš„åç»§æ”¾å…¥æ—§èŠ‚ç‚¹
    free(q);            //é‡Šæ”¾è¢«åˆ é™¤èŠ‚ç‚¹çš„åç»§ï¼Œåæ­£åç»§çš„æ•°æ®éƒ½æŒªåˆ°äº†æ—§èŠ‚ç‚¹ï¼ˆè¢«åˆ é™¤èŠ‚ç‚¹ï¼‰ï¼Œå“ˆå“ˆå“ˆğŸ˜‚
    return e;
}



//æ±‚è¡¨é•¿g
int GetLength(LinkList L){
    LNode *p=L->next;
    int i=0;
    while(p!= NULL){
        p=p->next;
        i++;
    }
    return i;
}

//éå†è¡¨æ ¼
void List_Show(LinkList L){
    LNode *p= L->next;
    printf("æ¥ä¸‹æ¥å¼€å§‹éå†å•é“¾è¡¨ \n");
    while(p!= NULL){
        printf("  %d",p->data);
        p=p->next;//åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
    }
    printf("\n ");
}



//////////////////////////
//é¡ºé¡ºåˆ©åˆ©ï¼Œæ°¸è¿œéƒ½ä¸è¦å‡ºbug//
/////////////////////////

int main() {
    cout << "Hello World!";
    LinkList L;
    List_TailInsert(L);
    LNode *x = GetElem(L,3);//æŒ‰ç…§åºå·æŸ¥æ‰¾å…ƒç´ 
    printf("æŸ¥æ‰¾åˆ°çš„å…ƒç´ ä¸º%d \n",x->data);
    LNode *t =LocateElem(L,5);//æŒ‰ç…§å€¼æ¥æŸ¥æ‰¾å…ƒç´ 
    printf("ä½¿ç”¨æŒ‰ç…§å€¼æ¥æŸ¥æ‰¾çš„æ–¹å¼æŸ¥æ‰¾åˆ°çš„èŠ‚ç‚¹ä¸º%d \n",t->data);
    //åœ¨ç¬¬iä¸ªå…ƒç´ åé¢æ’å…¥æ–°å…ƒç´ 
    bool b = List_Insert(L,3,0);
    printf("æ˜¯å¦æˆåŠŸ%d \n",b);
    printf("æŒ‰ç…§å†…å®¹æ’å…¥æ–°å…ƒç´  %d \n",List_InsertLocate(L,6,100));
    printf("è¡¨é•¿%d \n",GetLength(L));
    List_Show(L);//éå†æ•´ä¸ªå•é“¾è¡¨
    int e=List_Del(L,1);//åˆ é™¤ç¬¬ä¸€ä¸ªèŠ‚ç‚¹
    List_Show(L);
    e=List_DelPoint(t);//åˆ é™¤æŸ¥æ‰¾åˆ°çš„èŠ‚ç‚¹
    List_Show(L);
    return 0;
}